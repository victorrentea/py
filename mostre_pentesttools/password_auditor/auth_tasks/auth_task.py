"""This module holds the AuthTask base class."""


class AuthTask:
    """Base class that will be inherited by a service task class. It will most probably not be instantiated."""

    SUCCESS = 1
    FAILED = 2

    def __init__(self, task_id, host, port, username, password):
        self.id = task_id
        self.host = host
        self.port = port
        self.username = username
        self.password = password
        self.conn_status = AuthTask.FAILED
        self.auth_status = AuthTask.FAILED
        self.num_retries = 0

    def connect(self):
        """This method can be overridden by child classes in order to perform authentication."""
        pass

    def clean(self):
        """This method can be overridden by child classes in order to perform specific clean activities."""
        pass

    def add_screenshot(self, _scan_test):
        """If the service supports it, add a logged-in screenshot to the scan test finding."""

    def get_evidence(self):
        """This method can be overridden by child classes if they need to return various kinds of evidence and
        not only a username and password combination"""
        return None
